
<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Grokking</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
    <link rel="stylesheet" href="css/app.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
    
    <script src="js/app.js"></script>

    <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    
</head>

<body>
    <div class="container" id="main">
        <div class="row">
            <h2 class="col-md-12 text-center">
                Deep Networks <b>Always Grok</b> and Here is Why</br> 
                <small>
                    ArXiv 2024
                </small>
            </h2>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">
                <ul class="list-inline">
                    <li>
                        <a href="https://imtiazhumayun.github.io">
                          Ahmed Imtiaz Humayun
                        </a>
                        </br>Rice University
                    </li>
                    <li>
                        <a href="https://randallbalestriero.github.io/">
                            Randall Balestriero
                        </a>
                        </br>Independent
                    </li>
                    <li>
                        <a href="https://richb.rice.edu/">
                          Richard Baraniuk
                        </a>
                        </br>Rice University
                    </li>
                </ul>
            </div>
        </div>


        <div class="row">
                <div class="col-md-4 col-md-offset-4 text-center">
                    <ul class="nav nav-pills nav-justified">
                        <li>
                            <a href="#">
                            <image src="img/paper_logo.jpg" height="60px" style="
                            border-style: solid;
                            border-width: thin;
                            border-color: black;
                        ">
                                <h4><strong>Paper</strong></h4>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                            <image src="img/youtube_icon.png" height="60px">
                                <h4><strong>Video</strong></h4>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/AhmedImtiazPrio/grok-adversarial">
                            <image src="img/github.png" height="60px">
                                <h4><strong>Code</strong></h4>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                            <image src="img/colab_logo.svg" height="60px">
                                <h4><strong>Colab</strong></h4>
                            </a>
                        </li>
                    </ul>
                </div>
        </div>
        
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
<!--                 <div style="display: inline-flex;flex-wrap: inherit;justify-content: center;padding-top: 15px;padding-bottom: 15px">
                          <img src="img/cnn_cifar100_nobn.svg" alt="Cifar10-CNN" style="width: 100%; max-width: 200px; height: auto; margin-bottom: 10px;">
                          <img src="img/cnn_cifar10_nobn.svg" alt="Cifar100-CNN" style="width: 100%; max-width: 200px; height: auto; margin-bottom: 10px;">
                </div>
                <div style="display: inline-flex;flex-wrap: inherit;justify-content: center;padding-top: 15px;padding-bottom: 15px">
                          <img src="img/resnet_cifar10_nobn.svg" alt="Cifar10-Resnet" style="width: 100%; max-width: 200px; height: auto; margin-bottom: 10px;">
                          <img src="img/resnet_imagenette_nobn.svg" alt="Imagenette-Resnet" style="width: 100%; max-width: 200px; height: auto; margin-bottom: 10px;">
                </div> -->
                <div style="display: inline-flex;flex-wrap: inherit;justify-content: center;padding-top: 15px;padding-bottom: 15px">
                          <img src="img/cnn_cifar10_nobn.svg" alt="Cifar10-CNN" style="width: 100%; max-width: 50%; height: auto; margin-bottom: 10px;">
                          <img src="img/resnet_imagenette_nobn.svg" alt="Imagenette-Resnet" style="width: 100%; max-width: 50%; height: auto; margin-bottom: 10px;">
                </div>
        <!--                 <p class="text-justify">
                            Fig: <b>Deep Networks grok adversarial examples.</b> When training a Resnet18 on CIFAR10 without any controlled initialization as in (liu2022omnigrok), the network starts grokking adversarial examples generated using Projected Gradient Descent after 1e4 optimization steps (left) and attains almost equal robustness and generalization performance after 2x1e5 steps.  We see that prior to grokking, the network undergoes a phase change during training in the <it>local complexity</it>, i.e., the local density of non-linearities in the input space (right). After test accuracy converges, the network starts 'migrating' its non-linearities away from the data points, and closer to the decision boundary (in video above for MLP trained on MNIST) eventually reducing the complexity of the learned function around the data points. This increase and subsequent decrease in non-linearity is a ubiquitous phenomenon for a wide variety of networks and training settings (see paper). We see that this particular training dynamic always results in delayed generalizaion or robustness.                    
                        </p> -->
                <p class="text-justify">
                    Fig: <b>Grokking Adversarial Examples.</b> We observe that Deep Neural Networks grok adversarial examples, i.e., obtain delayed robustness, without any special intervention long after test set performance has converged. We present a novel model/data/training agnostic progress measure -- <it>local complexity</it> -- which undergoes a phase change when <it>delayed generalization</it> and/or <it>delayed robustness</it> occurs. In the figure, left is for a CNN trained on CIFAR10 and right is for a ResNet18 trained on Imagenette. See paper for CNN-CIFAR100, ResNet-CIFAR10, Transformers-ModAddition and more.
                </p>
            </div> 
        </div>     

        
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3 style="text-align: center;margin-top: 30px;margin-bottom: 30px;">
                    Abstract
                </h3>
                <p class="text-justify">
                    Grokking or delayed generalization, is a phenomenon where generalization in a Deep Neural Network (DNN) occurs long after achieving near zero training error. Previous studies have reported the occurrence of grokking in controlled settings, e.g., for transformers trained on algorithmic datasets (Power et al., 2022), or for DNNs initialized with large-norm parameters (Liu et al.,2022). We instead observe that for a large number of standard and practical settings, e.g., while training a CNN on CIFAR10, or a Resnet on Imagenette, DNNs grok adversarial examples, i.e., adversarial robustness emerges long after interpolation and/or generalization. We present a theoretically motivated explanation behind the emergence of delayed generalization and delayed robustness. We find that both phenomenon are tied, originating from a phase transition in the DNN’s input space partition geometry during training. We provide the first evidence that a migration of DNN ’linear regions’ occurs, making the function progresively linear around training samples and non-linear around the decision boundary during the latest phase of training. This migration provably induces grokking, as the emergence of a robust partition widens the linear regions around the training samples.
                </p>
                </div>
            </div>
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3 style="padding-bottom: 0px; text-align: center;">A Phase Change in the DNN Partition Geometry <br> Leads to Grokking</h3>
                <div style="display: flex;justify-content: center;align-items: center;padding-top: 5%;padding-bottom: 5px/* height: 400px; */">
                            <video autoplay="" muted="" loop="" playsinline="" playbackrate="2" width="100%" style="max-height: 400px;padding-right: 5px;width: 50%;">
                               <source src="img/splinecam_mnist.mp4#t=0.001" type="video/mp4">
                            </video>
                            <img src="img/mnist_mlp_grok.png" class="img-responsive" alt="mnist adversarial img" width="100%" style="padding-left: 1%;padding-top: 3%;width: auto;max-width: 50%;max-height: 450px;">
                </div>
                <p class="text-justify">
                    Fig: <b>Grokking Visualized.</b> Every neuron in a DNN learns feature thresholds/boundaries in the input space, dividing it into active and inactive regions. In the video we visualize the analytically computed partition formed by the neuron-thresholds (black lines) of a ReLU-MLP, around three MNIST training samples (white stars) in the input space. The DNN input-output mapping is linear/affine within each convex region, colored by the norm of the affine slope. In right-top we present the Train, Test and Adversarial accuracy (robustness) and right-bottom we present the local complexity, i.e., density of non-linearities, around all training, test or random data points. We see that the network starts grokking adversarial samples as soon as a phase change occurs in the partition (left), as well as phase change in the local complexity (right-bottom) approximately after 10,000 optimization steps.
                </p>
                <div style="display: flex; flex-wrap: inherit; justify-content: center; padding-top: 15px; padding-bottom: 15px">
                    <div style="text-align: center; width: 33%;">
                        <p>Accuracy</p>
                        <img src="img/grokking_acc.svg" alt="grok mnist acc" title="Accuracy Chart" style="width: 100%; height: auto; margin-bottom: 10px;">
                    </div>
                    <div style="text-align: center; width: 33%;">
                        <p>Train Local Complexity</p>
                        <img src="img/grokking_lc_train.svg" alt="grok mnist lc train" title="Training Loss Chart" style="width: 100%; height: auto; margin-bottom: 10px;">
                    </div>
                
                    <div style="text-align: center; width: 33%;">
                        <p>Test Local Complexity</p>
                        <img src="img/grokking_lc_test.svg" alt="grok mnist lc train" title="Testing Loss Chart" style="width: 100%; height: auto; margin-bottom: 10px;">
                    </div>
                </div>
                <p>
                        Fig: <b>Delayed Generalization.</b> Grokking induced for test samples via large-norm initialization (Liu et al., 2022) for MLPs for varying depth being trained on MNIST. 
                        We see that the local complexity (LC) training dynamics is similar to the case of delayed robustness. LC ascents with higher concentration around training samples, following
                        which it descends for training, test and random samples as well. <it> Where do the non-linearities migrate to? </it> We see that during the last phase of training, the non-linearities migrate
                        towards the decision boundary, linearizing the function everywhere else in the process.
                </p>
            </div>
        </div>
        
        
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3 style="padding-bottom: 20px; text-align: center;">Local Complexity - A New Progress Measure</h3>
                <div style="display: flex;justify-content: center;padding-top: 15px;padding-bottom: 15px">
                  <img src="img/toy_spline.svg" alt="Toy input" style="width: 500px;max-width: 100%;height: auto;margin-bottom: -10px;margin-top: -30px;">
                </div>
                <p class="text-justify">
                    Fig: <b>Linear Regions and Local Complexity.</b> Input space partition formed by a DNN trained to regress the piecewise function defined below (left) and graph of the learned function (right). Each partition region is randomly colored, and performs a single linear operation going from the input to the output. Learned function is more complex, i.e., densely changes the linear operation being performed, where the target function is non-flat.
                </p>
                <p class="text-justify">
                    <it>Progress Measures</it> are defined as scalars that have a causal link with the training state of a DNN. We propose local complexity as a fine-grained progress measure,
                    that at a high level, denotes how complex a DNN input-output mapping is for some local neighborhood in the input space. <it>How can we measure local complexity?</it> DNNs are continuous piecewise affine splines, therefore 
                    whenever it is trained to regress a function (could be a classification objective as well), it forms a piecewise linear spline approximation of the target function. For example,
                    suppose we are training an MLP to regress a target function \( f: \mathbb{R}^2 \rightarrow \mathbb{R} \) defined as,
<!--                     \( f(x_1,x_2) = sin(x_1) + cos(x_2) \) if \( x_1 < 0 \) else \( 0 \). -->
                </p>
                <p>                
                      \[
                      f(x_1, x_2) = 
                      \begin{cases} 
                      sin(x_1) + cos(x_2) & \text{if } x_1 < 0 \\
                      0 & \text{otherwise} 
                      \end{cases}
                      \]
                </p>
<!--                 <div style="display: inline-flex;flex-wrap: inherit;justify-content: center;padding-top: 15px;padding-bottom: 15px">
                  <img src="img/toy_spline_input.png" alt="Toy input" style="width: 100%; max-width: 50%; height: auto; margin-bottom: 10px;">
                  <img src="img/toy_spline_graph.png" alt="Toy graph" style="width: 100%; max-width: 50%; height: auto; margin-bottom: 10px;">
                </div>
                 -->
               
                <p>
                    Since the function is non-flat only for \( x_1 < 0 \) the DNN assigns more spline knots and forms more 'linear regions' for \( x_1<0 \), just like we would expect in any spline
                    interpolation task. A higher number of linear regions or non-linearities in some input domain, therefore denotes that the learned input-output mapping is more complex within that domain. 
                    Through local complexity we can therefore measure how non-linear a function is in some input space locality. For arbitrary dimensional input spaces, local complexity is computed for 
                    cross-polytopal input space neighborhoods with a given datapoint as a centroid. During training, these neighborhoods act as probes in the input space where we measure the complexity of the learned 
                    function throughout training, therefore monitoring how the non-linearity across different parts of the input space changes.
                </p>
                <div style="display: flex;justify-content: center;padding-top: 15px;padding-bottom: 15px">
                  <img src="img/local_complexity_approximation.svg" alt="Toy input" style="width: 100%;max-width: 100%;height: auto;">
                </div>
                <p class="text-justify">
                    Fig: <b>Local Complexity Approximation.</b> 1) Given a point in the input space \( x\in \mathbb{R}^D \), we start by sampling \( P \) orthonormal vectors
                        \( \{v_1,v_2,...,v_P\} \) to obtain cross-polytopal frame \( \mathbf{V}_x=\{x \pm r*v_p \forall p\} \) centered on \( x \),
                        where \( r \) is a radius parameter. 2) If any neuron hyperplane intersects the neighborhood \( conv(\mathbf{V}_x) \) then the pre-activation sign will be
                        different for the different vertices. We can therefore count the number neurons for a given layer, which results in sign changes in the pre-activation of 
                        \( \mathbf{V}_x \) to quantify local complexity \( x \) for that layer. 3) By embedding \( \mathbf{V}_x \) to the input of the next layer, 
                        we can obtain a coarse approximation of the local neighborhood of \( x \) and continue computing local complexity in a layerwise fashion.
                </p>
            </div>
        </div>  

         <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3 style="padding-bottom: 20px; text-align: center;">Connecting Spline Theory and Mechanistic Interpretability</h3>
                    <div style="display: flex;justify-content: center;padding-top: 15px;padding-bottom: 15px">
                        <svg width="200" height="200">
                            <polygon points="0.0,0.0 0.0,0.0 25.827093853006915,0.0 47.81395375930517,20.227433821128102 62.86782783736368,41.20861687494843 41.938668455206,49.279216085923515 0.0,20.799279155543417" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_0.svg')"></polygon>
                            <polygon points="62.86782783736368,41.20861687494843 69.67217099541344,50.69210056956322 47.36843834317719,52.96649347578782 41.938668455206,49.279216085923515" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_1.svg')"></polygon>
                            <polygon points="47.36843834317719,52.96649347578782 73.82909906377446,70.93554152183397 81.4048912807045,67.04445948717623 69.67217099541344,50.69210056956322" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_2.svg')"></polygon>
                            <polygon points="73.82909906377446,70.93554152183397 86.24701911894098,79.36836957776961 89.1700348003426,77.86704886051086 81.4048912807045,67.04445948717623" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_3.svg')"></polygon>
                            <polygon points="86.24701911894098,79.36836957776961 94.04833404874151,84.66612855197404 89.1700348003426,77.86704886051086" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_4.svg')"></polygon>
                            <polygon points="47.81395375930517,20.227433821128102 69.07569616218129,39.78777528002162 62.86782844488323,41.208617721672624" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_5.svg')"></polygon>
                            <polygon points="69.07569616218129,39.78777528002162 78.72116986148284,48.66140169859743 69.67217080025276,50.69210029756003 62.86782844488323,41.208617721672624" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_6.svg')"></polygon>
                            <polygon points="69.67217080025276,50.69210029756003 81.40489095218231,67.04445902930179 95.2379093393441,63.85644347141329 78.72116986148284,48.66140169859743" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_7.svg')"></polygon>
                            <polygon points="81.40489095218231,67.04445902930179 89.17003445127395,77.867048374 106.20080145095918,73.94206623068412 95.2379093393441,63.85644347141329" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_8.svg')"></polygon>
                            <polygon points="89.17003445127395,77.867048374 94.04833404874151,84.66612855197404 95.42489879281487,85.60093355499096 107.1450013206074,74.81070961398764 106.20080145095918,73.94206623068412" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_9.svg')"></polygon>
                            <polygon points="33.30089027358916,0.0 47.81395375930517,20.227433821128102 69.07570001963494,39.78777882879524 98.51147131661621,8.087792990317368 102.45639664694366,0.0" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_10.svg')"></polygon>
                            <polygon points="69.07570001963494,39.78777882879524 78.72117025825604,48.661402063620166 98.51147131661621,8.087792990317368" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_11.svg')"></polygon>
                            <polygon points="102.45639664694366,0.0 98.51147369179553,8.087788120780687 107.81096575791463,0.0" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_12.svg')"></polygon>
                            <polygon points="98.51147369179553,8.087788120780687 78.72117025825604,48.661402063620166 95.2379120906576,63.85644600256199 168.6612639519163,0.0 107.81096575791463,0.0" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_13.svg')"></polygon>
                            <polygon points="95.2379120906576,63.85644600256199 106.20080326589344,73.94206790038425 140.30629704334996,44.28044708652986 178.38234431596146,9.225371767398656 184.96437833110173,0.0 168.6612639519163,0.0" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_14.svg')"></polygon>
                            <polygon points="106.20080326589344,73.94206790038425 107.1450013206074,74.81070961398764 140.30629704334996,44.28044708652986" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_15.svg')"></polygon>
                            <polygon points="0.0,20.799279155543417 41.938670177500114,49.27921725550828 20.41185967002754,51.74910747695156 0.0,36.810502883869155" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_16.svg')"></polygon>
                            <polygon points="41.938670177500114,49.27921725550828 47.36843761096794,52.966492978555216 25.59514555819395,55.54254225594528 20.41185967002754,51.74910747695156" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_17.svg')"></polygon>
                            <polygon points="47.36843761096794,52.966492978555216 73.82910038865361,70.93554242154002 50.28512771285646,73.6121295831771 25.59514555819395,55.54254225594528" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_18.svg')"></polygon>
                            <polygon points="73.82910038865361,70.93554242154002 86.24701990083051,79.36837010873936 61.92799640729927,82.1330686140706 50.28512771285646,73.6121295831771" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_19.svg')"></polygon>
                            <polygon points="86.24701990083051,79.36837010873936 94.0483340487415,84.66612855197403 62.1571648531454,82.3007876192494 61.92799640729927,82.1330686140706" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_20.svg')"></polygon>
                            <polygon points="44.24727711628245,80.97242645742801 24.106860453955704,78.90640340934851 50.285128092473414,73.61212986100321 61.927996901146194,82.13306897549694 61.382711576744036,82.2433470775145" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_21.svg')"></polygon>
                            <polygon points="24.106860453955704,78.90640340934851 0.0,76.43349879422844 0.0,54.44681360910927 6.87970971371341,53.055466188395464 25.59514569175805,55.54254235369538 50.285128092473414,73.61212986100321" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_22.svg')"></polygon>
                            <polygon points="61.927996901146194,82.13306897549694 62.1571648531454,82.3007876192494 61.382711576744036,82.2433470775145" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_23.svg')"></polygon>
                            <polygon points="0.0,54.44681360910927 0.0,52.14122822604014 6.87970971371341,53.055466188395464" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_24.svg')"></polygon>
                            <polygon points="25.59514569175805,55.54254235369538 6.879707756698167,53.055465928329596 20.41185961836358,51.74910743914082" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_25.svg')"></polygon>
                            <polygon points="6.879707756698167,53.055465928329596 0.0,52.14122822604014 0.0,36.810502883869155 20.41185961836358,51.74910743914082" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_26.svg')"></polygon>
                            <polygon points="107.1450013206074,74.81070961398764 140.30624014468748,44.280499470824985 171.578099449151,18.762194024523154 124.99205724766792,84.05714046384891 111.90154499227417,80.58123140586052" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_27.svg')"></polygon>
                            <polygon points="140.30624014468748,44.280499470824985 178.38234431596146,9.225371767398656 171.578099449151,18.762194024523154" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_28.svg')"></polygon>
                            <polygon points="44.24727711628263,80.97242645742804 60.00770881436435,82.58914649266082 42.10810943797873,88.52256318309935 28.825264309451228,86.50866500610746 10.702284174287584,83.22479666672433 22.585579863065732,79.28568364555626" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_29.svg')"></polygon>
                            <polygon points="60.00770881436435,82.58914649266082 62.965793180503674,82.89258959322186 70.76997980839114,92.86817498009168 42.10810943797873,88.52256318309935" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_30.svg')"></polygon>
                            <polygon points="10.702284174287584,83.22479666672433 0.0,81.28555202280215 0.0,77.52700037892882 22.585579863065732,79.28568364555626" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_31.svg')"></polygon>
                            <polygon points="28.825264309451228,86.50866500610746 42.108109695313324,88.52256322211551 40.84043092470958,88.68580281379639" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_32.svg')"></polygon>
                            <polygon points="42.108109695313324,88.52256322211551 70.76997980839114,92.86817498009168 71.90106051300879,94.31396205392136 40.84043092470958,88.68580281379639" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_33.svg')"></polygon>
                            <polygon points="178.38234431596146,9.225371767398656 171.57809469162987,18.762200692659675 149.81710143760213,85.90240827587223 180.585560218845,80.88843073679327 192.29410281568966,70.69653502591463 200.0,46.921170982100676 200.0,0.0 188.4027390327055,0.0" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_34.svg')"></polygon>
                            <polygon points="171.57809469162987,18.762200692659675 124.99205632053639,84.05714176331547 135.83709908944368,88.18056651149595 149.81710143760213,85.90240827587223" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_35.svg')"></polygon>
                            <polygon points="192.29410281568966,70.69653502591463 200.0,63.988808610638195 200.0,46.921170982100676" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_36.svg')"></polygon>
                            <polygon points="180.585560218845,80.88843073679327 192.29410788303545,70.69653061495919 200.0,70.87739226633298 200.0,77.72468549727367" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_37.svg')"></polygon>
                            <polygon points="192.29410788303545,70.69653061495919 200.0,63.988808610638195 200.0,70.87739226633298" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_38.svg')"></polygon>
                            <polygon points="135.83709898826783,88.1805665279834 149.81710131373853,85.90240829605683 163.48176023539602,93.20361285143764 150.44541785538973,91.86633248274853" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_39.svg')"></polygon>
                            <polygon points="149.81710131373853,85.90240829605683 180.5855596321286,80.88843083240361 200.0,91.41881855627085 200.0,96.94968853070064 163.48176023539602,93.20361285143764" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_40.svg')"></polygon>
                            <polygon points="0.0,81.28555202280215 10.702284690504257,83.22479676026235 10.057787389642911,83.83360480843817 0.0,82.39999723969589" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_41.svg')"></polygon>
                            <polygon points="10.702284690504257,83.22479676026235 28.825290632331743,86.50866977579066 10.057787389642911,83.83360480843817" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_42.svg')"></polygon>
                            <polygon points="0.0,82.39999723969589 10.057788450630255,83.83360495966818 16.042873324571133,97.32352714382193 0.0,102.91173539251977" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_43.svg')"></polygon>
                            <polygon points="10.057788450630255,83.83360495966818 28.825290632331743,86.50866977579066 40.84043107897528,88.6858028417492 16.042873324571133,97.32352714382193" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_44.svg')"></polygon>
                            <polygon points="40.84043107897528,88.6858028417492 71.90106051300879,94.31396205392136 71.62998640679656,95.93010844000834 26.45360143554481,120.7885096888304 16.042873324571133,97.32352714382193" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_45.svg')"></polygon>
                            <polygon points="26.45360143554481,120.7885096888304 13.921000107923433,127.68460003983532 0.0,122.57807414620667 0.0,102.91173539251977 16.042873324571133,97.32352714382193" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_46.svg')"></polygon>
                            <polygon points="69.33341152006841,109.62230964442 71.62998640679656,95.93010844000834 26.453601866043826,120.78850945194742 35.504561276910664,125.27403853374724 56.19296901942645,121.72018309984192" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_47.svg')"></polygon>
                            <polygon points="26.453601866043826,120.78850945194742 13.921000343669192,127.68459991011571 15.651284848867704,128.68443508010057 35.504561276910664,125.27403853374724" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_48.svg')"></polygon>
                            <polygon points="56.19296901942645,121.72018309984192 35.50456286773928,125.27403826047464 51.14812410912337,126.36476758199267" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_49.svg')"></polygon>
                            <polygon points="35.50456286773928,125.27403826047464 15.651284848867704,128.68443508010057 35.912049966571104,140.39200425419898 51.14812410912337,126.36476758199267" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_50.svg')"></polygon>
                            <polygon points="134.53221253756183,90.23394078466856 168.49577216213277,107.84803578367237 193.64892838619437,116.37457050321406 200.0,117.5253791913097 200.0,115.18762887668136 169.58190511280313,98.3513500667589 150.44542226065997,91.86633293464533" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_51.svg')"></polygon>
                            <polygon points="200.0,115.18762887668136 200.0,108.65950689964501 169.58190511280313,98.3513500667589" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_52.svg')"></polygon>
                            <polygon points="150.44542226065997,91.86633293464533 169.58190382399732,98.3513496300053 163.48176735932242,93.20361358221678" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_53.svg')"></polygon>
                            <polygon points="169.58190382399732,98.3513496300053 200.0,108.65950689964501 200.0,96.94968853070064 163.48176735932242,93.20361358221678" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_54.svg')"></polygon>
                            <polygon points="0.0,173.45477485717834 0.0,174.16981949340195 24.641003650690692,175.5640038523986 38.66852935123849,163.0251030074365 49.84022426017757,143.56963236671885 35.91204450783364,140.39200927983757" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_55.svg')"></polygon>
                            <polygon points="0.0,174.16981949340195 0.0,197.59006233855723 24.641003650690692,175.5640038523986" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_56.svg')"></polygon>
                            <polygon points="24.641003650690692,175.5640038523986 31.25361944828019,175.93814468074083 38.66852935123849,163.0251030074365" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_57.svg')"></polygon>
                            <polygon points="0.0,197.59006233855723 0.0,200.0 17.436852353105962,200.0 31.25361944828019,175.93814468074083 24.641003650690692,175.5640038523986" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_58.svg')"></polygon>
                            <polygon points="35.91204450783364,140.39200927983757 51.14812863922288,126.36476341131345 60.808141071061904,124.46904062631495 49.84022426017757,143.56963236671885" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_59.svg')"></polygon>
                            <polygon points="51.14812863922288,126.36476341131345 56.19296853930905,121.72018354186659 64.39637741424917,118.22013861136855 60.808141071061904,124.46904062631495" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_60.svg')"></polygon>
                            <polygon points="64.396377164283,118.22013904668381 60.80813919524423,124.46904389304538 101.24173837210597,117.3455617508445 102.89116497806592,115.03372720121786 102.31826151721947,113.14420799702694" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_61.svg')"></polygon>
                            <polygon points="60.80813919524423,124.46904389304538 49.840224935683544,143.56963119032739 95.41881388696845,125.50696642078636 101.24173837210597,117.3455617508445" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_62.svg')"></polygon>
                            <polygon points="49.840224935683544,143.56963119032739 38.668523531338806,163.02511314277302 93.93886003427961,127.58126814244915 95.41881388696845,125.50696642078636" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_63.svg')"></polygon>
                            <polygon points="38.668523531338806,163.02511314277302 31.253617435327925,175.93814818629073 67.02381246544468,165.30536974820936 93.93886003427961,127.58126814244915" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_64.svg')"></polygon>
                            <polygon points="31.253617435327925,175.93814818629073 17.436852353105962,200.0 42.27020445725561,200.0 67.02381246544468,165.30536974820936" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_65.svg')"></polygon>
                            <polygon points="42.27020445725561,200.0 67.02381320238987,165.3053687153078 108.68390200473036,164.36906723680363 109.52294036840134,171.51495402297536 58.553077363946535,200.0" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_66.svg')"></polygon>
                            <polygon points="67.02381320238987,165.3053687153078 93.93885975264239,127.58126853719159 99.54601785934481,124.84609438152145 103.96029581219037,124.1392559005642 108.68390200473036,164.36906723680363" fill="green" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_67.svg')"></polygon>
                            <polygon points="93.93885975264239,127.58126853719159 95.41881503403131,125.50696481306431 99.54601785934481,124.84609438152145" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_68.svg')"></polygon>
                            <polygon points="95.41881503403131,125.50696481306431 99.5460176277725,124.84609441860209 103.8130386189837,122.88510200645587 103.1970613676689,117.63897275737787 101.24173889688566,117.34556101531385" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_69.svg')"></polygon>
                            <polygon points="99.5460176277725,124.84609441860209 103.96029581219037,124.1392559005642 103.8130386189837,122.88510200645587" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_70.svg')"></polygon>
                            <polygon points="103.1970613676689,117.63897275737787 102.89116497806592,115.03372720121786 101.24173889688566,117.34556101531385" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_71.svg')"></polygon>
                            <polygon points="102.89116497806592,115.03372720121786 103.19706138880669,117.63897293740328 164.0133249584776,141.06242739526175 165.06518663792392,140.4745833922696 163.6261890321587,135.97635394736906 104.26211094703378,113.11221081165608" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_72.svg')"></polygon>
                            <polygon points="103.19706138880669,117.63897293740328 103.81303859677254,122.88510181728881 158.70736906065417,144.0277168583383 164.0133249584776,141.06242739526175" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_73.svg')"></polygon>
                            <polygon points="103.81303859677254,122.88510181728881 103.96029580914133,124.13925587459622 157.43891295563708,144.7366069424276 158.70736906065417,144.0277168583383" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_74.svg')"></polygon>
                            <polygon points="103.96029580914133,124.13925587459622 108.6839019809674,164.36906703442034 116.75031935120492,167.47585698634907 157.43891295563708,144.7366069424276" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_75.svg')"></polygon>
                            <polygon points="108.6839019809674,164.36906703442034 109.52294036840134,171.51495402297536 116.75031935120492,167.47585698634907" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_76.svg')"></polygon>
                            <polygon points="165.06518663792392,140.4745833922696 165.55960810918765,142.02011843090983 164.01332519566083,141.06242726270938" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_77.svg')"></polygon>
                            <polygon points="165.55960810918765,142.02011843090983 167.59267448126968,148.37537502181505 165.12282612614166,147.4902641002342 158.7073665001209,144.02771828931935 164.01332519566083,141.06242726270938" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_78.svg')"></polygon>
                            <polygon points="165.12282612614166,147.4902641002342 157.4389128964413,144.7366069755098 158.7073665001209,144.02771828931935" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_79.svg')"></polygon>
                            <polygon points="157.4389128964413,144.7366069755098 165.12282641267345,147.49026420291761 167.7865622409229,148.98145777413075 184.10755275773334,200.0 176.8499621175839,200.0 116.75031944218904,167.47585693550164" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_80.svg')"></polygon>
                            <polygon points="165.12282641267345,147.49026420291761 167.59267448126968,148.37537502181505 167.7865622409229,148.98145777413075" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_81.svg')"></polygon>
                            <polygon points="176.8499621175839,200.0 112.86752825242787,200.0 109.52294036840134,171.51495402297536 116.75031944218904,167.47585693550164" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_82.svg')"></polygon>
                            <polygon points="171.18980621439067,137.0517750905837 179.88922419183,142.95942272114962 179.49378222034102,144.60802246281125 169.1919851854257,138.16827846158475" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_83.svg')"></polygon>
                            <polygon points="179.88922419183,142.95942272114962 200.0,156.61635670915746 200.0,157.4266396891881 179.49378222034102,144.60802246281125" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_84.svg')"></polygon>
                            <polygon points="169.1919851854257,138.16827846158475 179.49378144124043,144.60802197578863 174.2809371262366,146.52317490498467 165.55960814686946,142.0201185487011 165.06518663792392,140.4745833922696" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_85.svg')"></polygon>
                            <polygon points="179.49378144124043,144.60802197578863 200.0,157.4266396891881 200.0,159.80261773134168 174.2809371262366,146.52317490498467" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_86.svg')"></polygon>
                            <polygon points="174.2809371262366,146.52317490498467 168.36328136014026,148.69726933205084 167.59267452140358,148.37537514727148 165.55960814686946,142.0201185487011" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_87.svg')"></polygon>
                            <polygon points="200.0,159.80261773134168 200.0,161.9124073813918 168.36328136014026,148.69726933205084 174.2809371262366,146.52317490498467" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_88.svg')"></polygon>
                            <polygon points="167.59267452140358,148.37537514727148 168.36328076001263,148.6972690813684 167.7865592702601,148.98144848799794" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_89.svg')"></polygon>
                            <polygon points="168.36328076001263,148.6972690813684 200.0,161.9124073813918 200.0,200.0 184.10755275773334,200.0 167.7865592702601,148.98144848799794" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_90.svg')"></polygon>
                            <polygon points="62.965793180503645,82.89258959322184 60.00771291121198,82.58914691291933 61.38271167313831,82.24334708466398 62.1571648531454,82.3007876192494" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_91.svg')"></polygon>
                            <polygon points="60.00771291121198,82.58914691291933 44.24727711628245,80.97242645742801 61.38271167313831,82.24334708466398" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_92.svg')"></polygon>
                            <polygon points="0.0,76.43349879422844 24.106855887427614,78.90640294090973 22.585578937433766,79.28568357347959 0.0,77.52700037892882" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_93.svg')"></polygon>
                            <polygon points="24.106855887427614,78.90640294090973 44.24727711628263,80.97242645742804 22.585578937433766,79.28568357347959" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_94.svg')"></polygon>
                            <polygon points="200.0,156.61635670915746 200.0,124.44425128952192 179.88922745073467,142.95942493422416" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_95.svg')"></polygon>
                            <polygon points="200.0,124.44425128952192 200.0,117.5253791913097 193.64892838619437,116.37457050321404 171.18980621439067,137.0517750905837 179.88922745073467,142.95942493422416" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_96.svg')"></polygon>
                            <polygon points="95.42489879281487,85.60093355499096 96.50267346929112,86.33283458909244 104.98481975073918,87.20294120150594 111.9015448546162,80.58123123885727 107.1450013206074,74.81070961398764" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_97.svg')"></polygon>
                            <polygon points="104.98481975073918,87.20294120150594 113.63103574372431,88.08987824057895 117.51257063562052,87.38838970917992 111.9015448546162,80.58123123885727" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_98.svg')"></polygon>
                            <polygon points="111.90154499227417,80.58123140586052 117.51257063562052,87.38838970917992 123.37065981675923,86.32968935199362 124.99205724766792,84.05714046384891" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_99.svg')"></polygon>
                            <polygon points="62.965793180503674,82.89258959322186 70.76997958007931,92.86817468825548 89.82596681518896,90.75564356932452 94.8176692063031,86.1599852532613" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_100.svg')"></polygon>
                            <polygon points="70.76997958007931,92.86817468825548 71.90106051300879,94.31396205392136 73.90664501459595,94.67737223246814 88.29648321851948,92.16377719981276 89.82596681518896,90.75564356932452" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_101.svg')"></polygon>
                            <polygon points="96.50267346929112,86.33283458909244 102.73855727132907,90.567532158876 104.98482032419822,87.20294126033191" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_102.svg')"></polygon>
                            <polygon points="102.73855727132907,90.567532158876 103.46739470664235,91.06247501125561 113.63103574372431,88.08987824057895 104.98482032419822,87.20294126033191" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_103.svg')"></polygon>
                            <polygon points="124.99205632053639,84.05714176331547 123.37065981675923,86.32968935199362 130.9423123906133,88.97821291754471 135.83709908944368,88.18056651149595" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_104.svg')"></polygon>
                            <polygon points="130.9423123906133,88.97821291754471 135.83709898826783,88.1805665279834 150.44541785538973,91.86633248274853 134.53221253756183,90.23394078466856" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_105.svg')"></polygon>
                            <polygon points="180.5855596321286,80.88843083240361 200.0,77.72468549727367 200.0,91.41881855627085" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_106.svg')"></polygon>
                            <polygon points="0.0,122.57807414620667 -2.842170943040401e-14,131.4490656616662 10.4938953830531,129.5703716531854 13.921000107923433,127.68460003983532" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_107.svg')"></polygon>
                            <polygon points="-2.842170943040401e-14,131.4490656616662 -2.842170943040401e-14,135.34465975217995 10.4938953830531,129.5703716531854" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_108.svg')"></polygon>
                            <polygon points="15.651284848867704,128.68443508010057 10.49389544437308,129.57037161944393 13.921000343669192,127.68459991011571" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_109.svg')"></polygon>
                            <polygon points="35.912049966571104,140.39200425419898 0.0,173.45477485717834 -2.842170943040401e-14,135.34465975217995 10.49389544437308,129.57037161944393 15.651284848867704,128.68443508010057" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_110.svg')"></polygon>
                            <polygon points="94.8176692063031,86.1599852532613 89.82596716989713,90.75564324275908 102.73855653809592,90.56753166094808 96.50267346929112,86.33283458909244" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_111.svg')"></polygon>
                            <polygon points="89.82596716989713,90.75564324275908 88.29648321851948,92.16377719981276 103.46739470664235,91.06247501125561 102.73855653809592,90.56753166094808" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_112.svg')"></polygon>
                            <polygon points="56.19296853930905,121.72018354186659 69.33341152006841,109.62230964442 64.39637741424917,118.22013861136855" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_113.svg')"></polygon>
                            <polygon points="69.33341152006841,109.62230964442 64.396377164283,118.22013904668381 102.31826151721947,113.14420799702694 98.04527375499033,99.05127090065145 83.64886234309353,96.4426535935821" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_114.svg')"></polygon>
                            <polygon points="98.04527375499033,99.05127090065145 102.31826150271363,113.14420794918455 104.26211048887771,113.11221145380713 112.43400270285362,101.65849615187679" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_115.svg')"></polygon>
                            <polygon points="102.31826150271363,113.14420794918455 102.89116497806592,115.03372720121786 104.26211048887771,113.11221145380713" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_116.svg')"></polygon>
                            <polygon points="163.6261890321587,135.97635394736906 161.96654401148572,130.7883925010374 121.48612787224643,103.29873341010925 112.43400270285362,101.65849615187679 104.26211094703378,113.11221081165608" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_117.svg')"></polygon>
                            <polygon points="161.96654401148572,130.7883925010374 163.6261890377451,135.9763539648319 169.1919847394301,138.1682787108341 171.18980621439067,137.0517750905837" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_118.svg')"></polygon>
                            <polygon points="163.6261890377451,135.9763539648319 165.06518663792392,140.4745833922696 169.1919847394301,138.1682787108341" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_119.svg')"></polygon>
                            <polygon points="25.827093853006915,0.0 33.30089027358916,0.0 47.81395375930517,20.227433821128102" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_120.svg')"></polygon>
                            <polygon points="94.0483340487415,84.66612855197403 95.42489879281487,85.60093355499096 94.8176692063031,86.1599852532613 62.965793180503645,82.89258959322184 62.1571648531454,82.3007876192494" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_121.svg')"></polygon>
                            <polygon points="117.51257063562052,87.38838970917992 118.50272510416312,88.58962075685854 113.63103574372431,88.08987824057895" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_122.svg')"></polygon>
                            <polygon points="123.37065981675923,86.32968935199362 121.53624571299952,88.90080217876046 118.50272510416312,88.58962075685854 117.51257063562052,87.38838970917992" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_123.svg')"></polygon>
                            <polygon points="88.29648321851948,92.16377719981276 83.64886234309353,96.4426535935821 73.90664501459595,94.67737223246814" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_124.svg')"></polygon>
                            <polygon points="113.63103574372431,88.08987824057895 118.50272510416312,88.58962075685854 119.72623084464809,91.19084698002973 105.88308640016864,92.70293594168201 103.46739470664235,91.06247501125561" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_125.svg')"></polygon>
                            <polygon points="118.50272510416312,88.58962075685854 121.53624571299952,88.90080217876046 119.91725224056873,91.1699816812987 119.72623084464809,91.19084698002973" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_126.svg')"></polygon>
                            <polygon points="119.72623084464809,91.19084698002973 119.7962124543886,91.3396309148927 114.60008270624489,98.62252075836665 105.88308640016864,92.70293594168201" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_127.svg')"></polygon>
                            <polygon points="119.91725224056873,91.1699816812987 119.7962124543886,91.3396309148927 119.72623084464809,91.19084698002973" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_128.svg')"></polygon>
                            <polygon points="123.37065981675923,86.32968935199362 121.53624571299952,88.90080217876046 127.60016122844094,89.52284438506413 130.9423123906133,88.97821291754471" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_129.svg')"></polygon>
                            <polygon points="127.60016122844094,89.52284438506413 134.53221253756183,90.23394078466856 130.9423123906133,88.97821291754471" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_130.svg')"></polygon>
                            <polygon points="71.90106051300879,94.31396205392136 73.90664501459595,94.67737223246814 71.62998640679656,95.93010844000834" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_131.svg')"></polygon>
                            <polygon points="73.90664501459595,94.67737223246814 83.64886234309353,96.4426535935821 69.33341152006841,109.62230964442 71.62998640679656,95.93010844000834" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_132.svg')"></polygon>
                            <polygon points="88.29648321851948,92.16377719981276 83.64886234309353,96.4426535935821 98.04527375499033,99.05127090065145 105.88308640016864,92.70293594168201 103.46739470664235,91.06247501125561" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_133.svg')"></polygon>
                            <polygon points="98.04527375499033,99.05127090065145 112.43400270285362,101.65849615187679 114.60008270624489,98.62252075836665 105.88308640016864,92.70293594168201" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_134.svg')"></polygon>
                            <polygon points="121.53624571299952,88.90080217876046 127.60016122844091,89.52284438506413 119.91725224056873,91.1699816812987" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_135.svg')"></polygon>
                            <polygon points="127.60016122844091,89.52284438506413 134.53221253756183,90.23394078466856 168.49577216213277,107.84803578367237 119.7962124543886,91.3396309148927 119.91725224056873,91.1699816812987" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_136.svg')"></polygon>
                            <polygon points="168.49577216213277,107.84803578367237 180.25803956998942,113.94815302155422 121.48612787224643,103.29873341010925 114.60008270624489,98.62252075836665 119.7962124543886,91.3396309148927" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_137.svg')"></polygon>
                            <polygon points="193.64892838619437,116.37457050321406 180.25803956998942,113.94815302155422 168.49577216213277,107.84803578367237" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_138.svg')"></polygon>
                            <polygon points="112.86752825242787,200.0 58.553077363946535,200.0 109.52294036840134,171.51495402297536" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_139.svg')"></polygon>
                            <polygon points="171.18980621439067,137.0517750905837 161.96654401148572,130.7883925010374 180.25803956998936,113.9481530215542 193.64892838619437,116.37457050321404" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_140.svg')"></polygon>
                            <polygon points="161.96654401148572,130.7883925010374 121.48612787224643,103.29873341010925 180.25803956998936,113.9481530215542" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_141.svg')"></polygon>
                            <polygon points="178.38234431596146,9.225371767398656 188.4027390327055,0.0 184.96437833110173,0.0" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_142.svg')"></polygon>
                            <polygon points="95.42489879281487,85.60093355499096 94.8176692063031,86.1599852532613 96.50267346929112,86.33283458909244" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_143.svg')"></polygon>
                            <polygon points="114.60008270624489,98.62252075836665 112.43400270285362,101.65849615187679 121.48612787224643,103.29873341010925" fill="white" stroke="black" stroke-width="1" onmouseover="changeColor(this, 'img/toy_network/region_144.svg')"></polygon>
                        </svg>
                        
                        <svg id="imageContainer" width="200" height="200" style="margin-left : 30px;">
                          <!-- Placeholder for the initial state, replace with the default image if needed -->
                            <image href="img/toy_network/region_67.svg" width="100%" height="100%"></image>
                        </svg>
                    </div>
                
                <script>
                  function changeColor(clickedElement, imagePath) {
                    // Reset fill color for all polygons
                    const polygons = document.querySelectorAll('polygon');
                    polygons.forEach(polygon => {
                      polygon.setAttribute('fill', 'white');
                    });
                
                    // Set fill color for the clicked polygon
                    if (clickedElement.getAttribute('fill') === 'white') {
                      clickedElement.setAttribute('fill', 'green');
                      // Change the image in the second SVG based on the clicked polygon
                      updateImage(imagePath);
                    } else {
                      clickedElement.setAttribute('fill', 'white');
                      // Reset the image when polygon is deselected
                      updateImage('');
                    }
                  }
                
                  function updateImage(imagePath) {
                    const imageContainer = document.getElementById('imageContainer');
                    // Clear existing content
                    imageContainer.innerHTML = '';
                    
                    if (imagePath) {
                      // Add the new image
                      const image = document.createElementNS('http://www.w3.org/2000/svg', 'image');
                      image.setAttribute('href', imagePath);
                      image.setAttribute('width', '100%');
                      image.setAttribute('height', '100%');
                      imageContainer.appendChild(image);
                    } else {
                      // Placeholder or default behavior when no image is selected
                      // const placeholderRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                      // placeholderRect.setAttribute('width', '100%');
                      // placeholderRect.setAttribute('height', '100%');
                      // placeholderRect.setAttribute('fill', 'lightgray');
                      // imageContainer.appendChild(placeholderRect);
                    }
                  }
                </script>
                <p>
                    Fig Interactive: <b>Linear Regions and Circuits.</b> Input space spline partition (left) and network connectivity graph (right) for a randomly initialized 5 layer ReLU-MLP with 5 neurons in each layer,
                    2D input space, and 1D output space. Neurons are colored blue if active and orange if inactive. Hover and select any of the spline partition regions. 
                    Since the input-output mapping is linear per region, the activation/deactivation pattern of neurons remain the same for all vectors from any given region in the input space.
                    This means that each region creates a unique <it>circuit</it> (Olah et al., 2020) comprising of a subset of neurons in the network. The circuit for any two neighboring regions
                    vary by only one neuron being activated/deactivated. This is due to the fact that the knots of the spline partition are the zero level sets of the neurons in the input space. This means that
                    crossing a boundary is equivalent to flipping on or off a neuron in the circuit. 
                </p>
                <div style="display: flex;justify-content: center;align-items: center;padding-top: 15px;padding-bottom: 15px">
                    <div style="display: flex; flex-wrap: wrap; max-width: 50%;">
                        <div style="display: flex; width: 100%;">
                            <div style="width: 50%; margin: 0px; text-align: center;">
                                <p>Layer 1</p>
                                <img src="img/layerwise1.png" alt="Small Image 1" style="width: 100%; height: auto;">
                            </div>
                            <div style="width: 50%; margin: 0px; text-align: center;">
                                <p>Layer 2</p>
                                <img src="img/layerwise2.png" alt="Small Image 2" style="width: 100%; height: auto;">
                            </div>
                        </div>
                
                        <div style="display: flex; width: 100%;">
                            <div style="width: 50%; margin: 0px; text-align: center;">
                                <p>Layer 3</p>
                                <img src="img/layerwise3.png" alt="Small Image 3" style="width: 100%; height: auto;">
                            </div>
                            <div style="width: 50%; margin: 0px; text-align: center;">
                                <p>Layer 4</p>
                                <img src="img/layerwise4.png" alt="Small Image 4" style="width: 100%; height: auto;">
                            </div>
                        </div>
                    </div>
                
                    <div style="display: flex;flex-wrap: wrap;max-width: 50%;margin-left: 0px;">
                        <div style="width: 100%; margin: 5px; text-align: center;">
                            <p>Layer 5</p>
                            <img src="img/layerwise5.png" alt="Small Image 5" style="width: 100%; height: auto;">
                        </div>
                    </div>
                </div>
                <p>
                    Fig: <b>Layerwise contribution in the Spline Partition. </b> Non-linearities in a DNN accumulates around
                    the decision boundary during grokking, but not equivalently across all layers. This is due to the layerwise sub-division
                    of the spline partition, deeper layer neurons can be more localized, therefore deeper layers undergo region migration more than shallower layers.
                    Large regions formed in deeper layers would mean deeper layers have more generalized circuits, i.e., the same circuits working for a larger number
                    of data points.
                </p>
            </div>
        </div>
                        
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3 style="padding-bottom: 20px; text-align: center;">Generalization/Memorization vs Local Complexity Dynamics</h3>
                More data can delay or hasten. 
            </div>
        </div>
    </div>
</body>
</html>
